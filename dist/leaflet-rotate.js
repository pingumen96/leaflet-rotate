!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).LeafletRotate={})}(this,(function(t){"use strict";function e(t){if(!t||"object"!=typeof t)throw new Error("Leaflet namespace required");return function(t){t.Point&&!t.Point.__leafletRotateInstalled&&(t.extend(t.Point.prototype,{rotate:function(e){return this.rotateFrom(e,new t.Point(0,0))},rotateFrom:function(e,o){if(!e)return this;var i=Math.sin(e),n=Math.cos(e),a=o.x,s=o.y,r=this.x-a,h=this.y-s;return new t.Point(r*n-h*i+a,r*i+h*n+s)}}),t.Point.__leafletRotateInstalled=!0)}(t),function(t){if(t.DomUtil&&t.DomUtil.__leafletRotateInstalled)return;const e=t.extend({},t.DomUtil);t.extend(t.DomUtil,{setTransform:function(o,i,n,a,s){var r=i||new t.Point(0,0);if(!a)return i=r._round(),e.setTransform.apply(this,arguments);r=r.rotateFrom(a,s),o.style[t.DomUtil.TRANSFORM]="translate3d("+r.x+"px,"+r.y+"px,0)"+(n?" scale("+n+")":"")+" rotate("+a+"rad)"},setPosition:function(o,i,n,a,s){if(!n)return e.setPosition.apply(this,arguments);o._leaflet_pos=i,t.Browser.any3d?t.DomUtil.setTransform(o,i,s,n,a):(o.style.left=i.x+"px",o.style.top=i.y+"px")},DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI}),t.DomUtil.__leafletRotateInstalled=!0}(t),function(t){t.Draggable&&!t.Draggable.__leafletRotateInstalled&&(t.Draggable.include({}),t.Draggable.__leafletRotateInstalled=!0)}(t),function(t){if(!t.Map||t.Map.__leafletRotateInstalled)return;const e=t.extend({},t.Map.prototype);t.Map.mergeOptions({rotate:!1,bearing:0}),t.Map.include({initialize:function(t,o){o.rotate&&(this._rotate=!0,this._bearing=0),e.initialize.apply(this,arguments),this.options.rotate&&this.setBearing(this.options.bearing)},containerPointToLayerPoint:function(o){return this._rotate?t.point(o).subtract(this._getMapPanePos()).rotateFrom(-this._bearing,this._getRotatePanePos()).subtract(this._getRotatePanePos()):e.containerPointToLayerPoint.apply(this,arguments)},layerPointToContainerPoint:function(o){return this._rotate?t.point(o).add(this._getRotatePanePos()).rotateFrom(this._bearing,this._getRotatePanePos()).add(this._getMapPanePos()):e.layerPointToContainerPoint.apply(this,arguments)},rotatedPointToMapPanePoint:function(e){return t.point(e).rotate(this._bearing)._add(this._getRotatePanePos())},mapPanePointToRotatedPoint:function(e){return t.point(e)._subtract(this._getRotatePanePos()).rotate(-this._bearing)},mapBoundsToContainerBounds:function(o){if(!this._rotate&&e.mapBoundsToContainerBounds)return e.mapBoundsToContainerBounds.apply(this,arguments);const i=this.getPixelOrigin(),n=this.layerPointToContainerPoint(this.project(o.getNorthWest())._subtract(i)),a=this.layerPointToContainerPoint(this.project(o.getNorthEast())._subtract(i)),s=this.layerPointToContainerPoint(this.project(o.getSouthWest())._subtract(i)),r=this.layerPointToContainerPoint(this.project(o.getSouthEast())._subtract(i));return t.bounds([t.point(Math.min(n.x,a.x,r.x,s.x),Math.min(n.y,a.y,r.y,s.y)),t.point(Math.max(n.x,a.x,r.x,s.x),Math.max(n.y,a.y,r.y,s.y))])},getBounds:function(){if(!this._rotate)return e.getBounds.apply(this,arguments);var o=this.getSize();return new t.LatLngBounds([this.containerPointToLatLng([0,0]),this.containerPointToLatLng([o.x,0]),this.containerPointToLatLng([o.x,o.y]),this.containerPointToLatLng([0,o.y])])},setBearing:function(e){if(t.Browser.any3d&&this._rotate){var o=t.Util.wrapNum(e,[0,360])*t.DomUtil.DEG_TO_RAD,i=this._getPixelCenter(),n=this._getRotatePanePos().rotateFrom(-this._bearing,i),a=n.rotateFrom(o,i);t.DomUtil.setPosition(this._rotatePane,n,o,i),this._pivot=i,this._bearing=o,this._rotatePanePos=a,this.fire("rotate")}},getBearing:function(){return this._bearing*t.DomUtil.RAD_TO_DEG},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),t.DomUtil.setPosition(this._mapPane,new t.Point(0,0)),this._rotate?(this._rotatePane=this.createPane("rotatePane",this._mapPane),this._norotatePane=this.createPane("norotatePane",this._mapPane),this.createPane("tilePane",this._rotatePane),this.createPane("overlayPane",this._rotatePane),this.createPane("shadowPane",this._norotatePane),this.createPane("markerPane",this._norotatePane),this.createPane("tooltipPane",this._norotatePane),this.createPane("popupPane",this._norotatePane)):(this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane")),this.options.markerZoomAnimation||(t.DomUtil.addClass(e.markerPane,"leaflet-zoom-hide"),t.DomUtil.addClass(e.shadowPane,"leaflet-zoom-hide"))},panInside(o,i){if(!this._rotate||Math.abs(this._bearing).toFixed(1)<.1)return e.panInside.apply(this,arguments);i=i||{};const n=t.point(i.paddingTopLeft||i.padding||[0,0]),a=t.point(i.paddingBottomRight||i.padding||[0,0]),s=this._container.getBoundingClientRect(),r=this.latLngToContainerPoint(o),h=t.bounds([t.point(s),t.point(s).add(this.getSize())]),l=h.getCenter(),_=t.bounds([h.min.add(n),h.max.subtract(a)]),d=_.getSize();if(!_.contains(r)){this._enforcingBounds=!0;const t=r.subtract(_.getCenter()),e=_.extend(r).getSize().subtract(d);l.x+=t.x<0?-e.x:e.x,l.y+=t.y<0?-e.y:e.y,this.panTo(this.containerPointToLatLng(l),i),this._enforcingBounds=!1}return this},getBoundsZoom(o,i,n){if(!this._rotate||Math.abs(this._bearing).toFixed(1)<.1)return e.getBoundsZoom.apply(this,arguments);o=t.latLngBounds(o),n=t.point(n||[0,0]);let a=this.getZoom()||0;const s=this.getMinZoom(),r=this.getMaxZoom(),h=this.getSize().subtract(n),l=this.mapBoundsToContainerBounds(o).getSize(),_=this.options.zoomSnap,d=h.x/l.x,p=h.y/l.y,c=i?Math.max(d,p):Math.min(d,p);return a=this.getScaleZoom(c,a),_&&(a=Math.round(a/(_/100))*(_/100),a=i?Math.ceil(a/_)*_:Math.floor(a/_)*_),Math.max(s,Math.min(r,a))},_getCenterOffset:function(t){var o=e._getCenterOffset.apply(this,arguments);return this._rotate&&(o=o.rotate(this._bearing)),o},_getRotatePanePos:function(){return this._rotatePanePos||new t.Point(0,0)},_getNewPixelOrigin:function(t,o){if(!this._rotate)return e._getNewPixelOrigin.apply(this,arguments);var i=this.getSize()._divideBy(2);return this.project(t,o).rotate(this._bearing)._subtract(i)._add(this._getMapPanePos())._add(this._getRotatePanePos()).rotate(-this._bearing)._round()},_getNewPixelBounds:function(o,i){if(o=o||this.getCenter(),i=i||this.getZoom(),!this._rotate&&e._getNewPixelBounds)return e._getNewPixelBounds.apply(this,arguments);var n=this._animatingZoom?Math.max(this._animateToZoom,this.getZoom()):this.getZoom(),a=this.getZoomScale(n,i),s=this.project(o,i).floor(),r=this.getSize(),h=new t.Bounds([this.containerPointToLayerPoint([0,0]).floor(),this.containerPointToLayerPoint([r.x,0]).floor(),this.containerPointToLayerPoint([0,r.y]).floor(),this.containerPointToLayerPoint([r.x,r.y]).floor()]).getSize().divideBy(2*a);return new t.Bounds(s.subtract(h),s.add(h))},_getPixelCenter:function(){return!this._rotate&&e._getPixelCenter?e._getPixelCenter.apply(this,arguments):this.getSize()._divideBy(2)._subtract(this._getMapPanePos())},_getPaddedPixelBounds:function(o){if(!this._rotate&&e._getPaddedPixelBounds)return e._getPaddedPixelBounds.apply(this,arguments);var i=o,n=this.getSize(),a=n.multiplyBy(-i),s=n.multiplyBy(1+i);return new t.Bounds([this.containerPointToLayerPoint([a.x,a.y]).floor(),this.containerPointToLayerPoint([a.x,s.y]).floor(),this.containerPointToLayerPoint([s.x,a.y]).floor(),this.containerPointToLayerPoint([s.x,s.y]).floor()])},_handleGeolocationResponse:function(e){if(this._container._leaflet_id){var o=e.coords.latitude,i=e.coords.longitude,n=e.coords.heading,a=new t.LatLng(o,i),s=a.toBounds(e.coords.accuracy),r=this._locateOptions;if(r.setView){var h=this.getBoundsZoom(s);this.setView(a,r.maxZoom?Math.min(h,r.maxZoom):h)}var l={latlng:a,bounds:s,timestamp:e.timestamp,heading:n};for(var _ in e.coords)"number"==typeof e.coords[_]&&(l[_]=e.coords[_]);this.fire("locationfound",l)}}}),t.Map.__leafletRotateInstalled=!0}(t),function(t){if(!t.DivOverlay||t.DivOverlay.__leafletRotateInstalled)return;const e=t.extend({},t.DivOverlay.prototype);t.DivOverlay.include({getEvents:function(){return t.extend(e.getEvents.apply(this,arguments),{rotate:this._updatePosition})},_updatePosition:function(){if(this._map&&(e._updatePosition.apply(this,arguments),this._map&&this._map._rotate&&this._zoomAnimated)){var o=this._getAnchor(),i=t.DomUtil.getPosition(this._container).subtract(o);t.DomUtil.setPosition(this._container,this._map.rotatedPointToMapPanePoint(i).add(o))}}}),t.DivOverlay.__leafletRotateInstalled=!0}(t),function(t){if(!t.Popup||t.Popup.__leafletRotateInstalled)return;const e=t.extend({},t.Popup.prototype);t.Popup.include({_animateZoom:function(o){if(e._animateZoom.apply(this,arguments),this._map&&this._map._rotate){var i=this._getAnchor(),n=t.DomUtil.getPosition(this._container).subtract(i);t.DomUtil.setPosition(this._container,this._map.rotatedPointToMapPanePoint(n).add(i))}},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress))if(this._autopanning)this._autopanning=!1;else{var e=this._map,o=parseInt(t.DomUtil.getStyle(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+o,n=this._containerWidth,a=new t.Point(this._containerLeft,-i-this._containerBottom);a._add(t.DomUtil.getPosition(this._container));var s=a._add(this._map._getMapPanePos()),r=t.point(this.options.autoPanPadding),h=t.point(this.options.autoPanPaddingTopLeft||r),l=t.point(this.options.autoPanPaddingBottomRight||r),_=e.getSize(),d=0,p=0;s.x+n+l.x>_.x&&(d=s.x+n-_.x+l.x),s.x-d-h.x<0&&(d=s.x-h.x),s.y+i+l.y>_.y&&(p=s.y+i-_.y+l.y),s.y-p-h.y<0&&(p=s.y-h.y),(d||p)&&(this.options.keepInView&&(this._autopanning=!0),e.fire("autopanstart").panBy([d,p]))}}}),t.Popup.__leafletRotateInstalled=!0}(t),function(t){if(!t.Tooltip||t.Tooltip.__leafletRotateInstalled)return;const e=t.extend({},t.Tooltip.prototype);t.Tooltip.include({_animateZoom:function(t){if(!this._map._rotate)return e._animateZoom.apply(this,arguments);var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);o=this._map.rotatedPointToMapPanePoint(o),this._setPosition(o)},_updatePosition:function(){if(!this._map._rotate)return e._updatePosition.apply(this,arguments);var t=this._map.latLngToLayerPoint(this._latlng);t=this._map.rotatedPointToMapPanePoint(t),this._setPosition(t)}}),t.Tooltip.__leafletRotateInstalled=!0}(t),function(t){t.Icon&&!t.Icon.__leafletRotateInstalled&&(t.extend({},t.Icon.prototype),t.Icon.include({_setIconStyles:function(e,o){var i=this.options,n=i[o+"Size"];"number"==typeof n&&(n=[n,n]);var a=t.point(n),s=t.point("shadow"===o&&i.shadowAnchor||i.iconAnchor||a&&a.divideBy(2,!0));e.className="leaflet-marker-"+o+" "+(i.className||""),s&&(e.style.marginLeft=-s.x+"px",e.style.marginTop=-s.y+"px",e.style[t.DomUtil.TRANSFORM+"Origin"]=s.x+"px "+s.y+"px 0px"),a&&(e.style.width=a.x+"px",e.style.height=a.y+"px")}}),t.Icon.__leafletRotateInstalled=!0)}(t),function(t){if(!t.Marker||t.Marker.__leafletRotateInstalled)return;const e=t.extend({},t.Marker.prototype);var o;t.Marker.mergeOptions({rotation:0,rotateWithView:!1,scale:void 0});var i={_onDrag:function(e){var o=this._marker,i=o.options.rotation||o.options.rotateWithView,n=o._shadow,a=t.DomUtil.getPosition(o._icon);!i&&n&&t.DomUtil.setPosition(n,a),o._map._rotate&&(a=o._map.mapPanePointToRotatedPoint(a));var s=o._map.layerPointToLatLng(a);o._latlng=s,e.latlng=s,e.oldLatLng=this._oldLatLng,i?o.setLatLng(s):o.fire("move",e),o.fire("drag",e)},_onDragEnd:function(t){this._marker._map._rotate&&this._marker.update(),o._onDragEnd.apply(this,arguments)}};t.Marker.include({getEvents:function(){return t.extend(e.getEvents.apply(this,arguments),{rotate:this.update})},_initInteraction:function(){var t=e._initInteraction.apply(this,arguments);return this.dragging&&this.dragging.enabled()&&this._map&&this._map._rotate&&(o=o||Object.getPrototypeOf(this.dragging),this.dragging.disable(),Object.assign(this.dragging,{_onDrag:i._onDrag.bind(this.dragging),_onDragEnd:i._onDragEnd.bind(this.dragging)}),this.dragging.enable()),t},_setPos:function(e){this._map._rotate&&(e=this._map.rotatedPointToMapPanePoint(e));var o=this.options.rotation||0;this.options.rotateWithView&&(o+=this._map._bearing),this._icon&&t.DomUtil.setPosition(this._icon,e,o,e,this.options.scale),this._shadow&&t.DomUtil.setPosition(this._shadow,e,o,e,this.options.scale),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},setRotation:function(t){this.options.rotation=t,this.update()}}),t.Marker.__leafletRotateInstalled=!0}(t),function(t){if(!t.GridLayer||t.GridLayer.__leafletRotateInstalled)return;const e=t.extend({},t.GridLayer.prototype);t.GridLayer.include({getEvents:function(){var o=e.getEvents.apply(this,arguments);return this._map._rotate&&!this.options.updateWhenIdle&&(this._onRotate||(this._onRotate=t.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),o.rotate=this._onRotate),o},_getTiledPixelBounds:function(t){return this._map._rotate?this._map._getNewPixelBounds(t,this._tileZoom):e._getTiledPixelBounds.apply(this,arguments)}}),t.GridLayer.__leafletRotateInstalled=!0}(t),function(t){if(!t.Renderer||t.Renderer.__leafletRotateInstalled)return;const e=t.extend({},t.Renderer.prototype);t.Renderer.include({getEvents:function(){return t.extend(e.getEvents.apply(this,arguments),{rotate:this._update})},onAdd:function(){e.onAdd.apply(this,arguments),t.version<="1.9.3"&&this._container.classList.add("leaflet-zoom-animated")},_updateTransform:function(o,i){if(!this._map._rotate)return e._updateTransform.apply(this,arguments);var n=this._map.getZoomScale(i,this._zoom),a=this._map._latLngToNewLayerPoint(this._topLeft,i,o);t.DomUtil.setTransform(this._container,a,n)},_update:function(){if(!this._map._rotate)return e._update.apply(this,arguments);this._bounds=this._map._getPaddedPixelBounds(this.options.padding),this._topLeft=this._map.layerPointToLatLng(this._bounds.min),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),t.Renderer.__leafletRotateInstalled=!0}(t),function(t){t.Map&&t.Map.CompassBearing||(t.Map.CompassBearing=t.Handler.extend({initialize:function(e){this._map=e,"ondeviceorientationabsolute"in window?this.__deviceOrientationEvent="deviceorientationabsolute":"ondeviceorientation"in window&&(this.__deviceOrientationEvent="deviceorientation"),this._throttled=t.Util.throttle(this._onDeviceOrientation,100,this)},addHooks:function(){this._map._rotate&&this.__deviceOrientationEvent?t.DomEvent.on(window,this.__deviceOrientationEvent,this._throttled,this):this.disable()},removeHooks:function(){this._map._rotate&&this.__deviceOrientationEvent&&t.DomEvent.off(window,this.__deviceOrientationEvent,this._throttled,this)},_onDeviceOrientation:function(t){var e=t.webkitCompassHeading||t.alpha,o=0;!t.absolute&&t.webkitCompassHeading&&(e=360-e),t.absolute||void 0===window.orientation||(o=window.orientation),this._map.setBearing(e-o)}}),t.Map.addInitHook("addHandler","compassBearing",t.Map.CompassBearing))}(t),function(t){t.Map&&t.Map.ContainerMutation||(t.Map.mergeOptions({trackContainerMutation:!1}),t.Map.ContainerMutation=t.Handler.extend({addHooks:function(){this._observer||(this._observer=new MutationObserver(t.Util.bind(this._map.invalidateSize,this._map))),this._observer.observe(this._map.getContainer(),{childList:!1,attributes:!0,characterData:!1,subtree:!1,attributeFilter:["style"]})},removeHooks:function(){this._observer.disconnect()}}),t.Map.addInitHook("addHandler","trackContainerMutation",t.Map.ContainerMutation))}(t),function(t){t.Map&&t.Map.TouchGestures||(t.Map.mergeOptions({bounceAtZoomLimits:!0}),t.Map.TouchGestures=t.Handler.extend({initialize:function(t){this._map=t,this.rotate=!!this._map.options.touchRotate,this.zoom=!!this._map.options.touchZoom},addHooks:function(){t.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){t.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var o=this._map;if(e.touches&&2===e.touches.length&&!o._animatingZoom&&!this._zooming&&!this._rotating){var i=o.mouseEventToContainerPoint(e.touches[0]),n=o.mouseEventToContainerPoint(e.touches[1]),a=i.subtract(n);this._centerPoint=o.getSize()._divideBy(2),this._startLatLng=o.containerPointToLatLng(this._centerPoint),this.zoom?("center"!==o.options.touchZoom&&(this._pinchStartLatLng=o.containerPointToLatLng(i.add(n)._divideBy(2))),this._startDist=i.distanceTo(n),this._startZoom=o.getZoom(),this._zooming=!0):this._zooming=!1,this.rotate?(this._startTheta=Math.atan(a.x/a.y),this._startBearing=o.getBearing(),a.y<0&&(this._startBearing+=180),this._rotating=!0):this._rotating=!1,this._moved=!1,o._stop(),t.DomEvent.on(document,"touchmove",this._onTouchMove,this).on(document,"touchend touchcancel",this._onTouchEnd,this),t.DomEvent.preventDefault(e)}},_onTouchMove:function(e){if(e.touches&&2===e.touches.length&&(this._zooming||this._rotating)){var o,i=this._map,n=i.mouseEventToContainerPoint(e.touches[0]),a=i.mouseEventToContainerPoint(e.touches[1]),s=n.subtract(a),r=n.distanceTo(a)/this._startDist;if(this._rotating){var h=(Math.atan(s.x/s.y)-this._startTheta)*t.DomUtil.RAD_TO_DEG;s.y<0&&(h+=180),h&&i.setBearing(this._startBearing-h)}if(this._zooming)if(this._zoom=i.getScaleZoom(r,this._startZoom),!i.options.bounceAtZoomLimits&&(this._zoom<i.getMinZoom()&&r<1||this._zoom>i.getMaxZoom()&&r>1)&&(this._zoom=i._limitZoom(this._zoom)),"center"===i.options.touchZoom){if(this._center=this._startLatLng,1===r)return}else{if(o=n._add(a)._divideBy(2)._subtract(this._centerPoint),1===r&&0===o.x&&0===o.y)return;var l=-i.getBearing()*t.DomUtil.DEG_TO_RAD;this._center=i.unproject(i.project(this._pinchStartLatLng).subtract(o.rotate(l)))}this._moved||(i._moveStart(!0,!1),this._moved=!0),t.Util.cancelAnimFrame(this._animRequest);var _=i._move.bind(i,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=t.Util.requestAnimFrame(_,this,!0),t.DomEvent.preventDefault(e)}},_onTouchEnd:function(){this._moved&&(this._zooming||this._rotating)?(this._zooming=!1,this._rotating=!1,t.Util.cancelAnimFrame(this._animRequest),t.DomEvent.off(document,"touchmove",this._onTouchMove,this).off(document,"touchend touchcancel",this._onTouchEnd,this),this.zoom&&(this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom)))):this._zooming=!1}}),t.Map.addInitHook("addHandler","touchGestures",t.Map.TouchGestures))}(t),function(t){t.Map&&t.Map.TouchRotate||(t.Map.mergeOptions({touchRotate:!1}),t.Map.TouchRotate=t.Handler.extend({addHooks:function(){this._map.touchGestures.enable(),this._map.touchGestures.rotate=!0},removeHooks:function(){this._map.touchGestures.rotate=!1}}),t.Map.addInitHook("addHandler","touchRotate",t.Map.TouchRotate))}(t),function(t){t.Map&&t.Map.ShiftKeyRotate||(t.Map.mergeOptions({shiftKeyRotate:!0}),t.Map.ShiftKeyRotate=t.Handler.extend({addHooks:function(){t.DomEvent.on(this._map._container,"wheel",this._handleShiftScroll,this),this._map.shiftKeyRotate.rotate=!0},removeHooks:function(){t.DomEvent.off(this._map._container,"wheel",this._handleShiftScroll,this),this._map.shiftKeyRotate.rotate=!1},_handleShiftScroll:function(e){e.shiftKey?(e.preventDefault(),this._map.scrollWheelZoom.disable(),this._map.setBearing(this._map._bearing*t.DomUtil.RAD_TO_DEG+5*Math.sign(e.deltaY))):this._map.scrollWheelZoom.enable()}}),t.Map.addInitHook("addHandler","shiftKeyRotate",t.Map.ShiftKeyRotate),t.Map.addInitHook((function(){this.scrollWheelZoom.enabled()&&this.shiftKeyRotate.enabled()&&(this.scrollWheelZoom.disable(),this.scrollWheelZoom.enable())})))}(t),function(t){t.Map&&t.Map.TouchZoom||(t.Map.mergeOptions({touchZoom:t.Browser.touch,bounceAtZoomLimits:!1}),t.Map.TouchZoom=t.Handler.extend({addHooks:function(){t.DomUtil.addClass(this._map._container,"leaflet-touch-zoom"),this._map.touchGestures.enable(),this._map.touchGestures.zoom=!0},removeHooks:function(){t.DomUtil.removeClass(this._map._container,"leaflet-touch-zoom"),this._map.touchGestures.zoom=!1}}),t.Map.addInitHook("addHandler","touchZoom",t.Map.TouchZoom))}(t),function(t){t.Control&&t.Control.Rotate||(t.Control.Rotate=t.Control.extend({options:{position:"topleft",closeOnZeroBearing:!0},onAdd:function(e){var o=this._container=t.DomUtil.create("div","leaflet-control-rotate leaflet-bar"),i=this._arrow=t.DomUtil.create("span","leaflet-control-rotate-arrow");i.style.backgroundImage="url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")",i.style.cursor="grab",i.style.display="block",i.style.width="100%",i.style.height="100%",i.style.backgroundRepeat="no-repeat",i.style.backgroundPosition="50%";var n=this._link=t.DomUtil.create("a","leaflet-control-rotate-toggle",o);return n.appendChild(i),n.href="#",n.title="Rotate map",t.DomEvent.on(n,"dblclick",t.DomEvent.stopPropagation).on(n,"mousedown",this._handleMouseDown,this).on(n,"click",t.DomEvent.stop).on(n,"click",this._cycleState,this).on(n,"click",this._refocusOnMap,this),t.Browser.any3d||t.DomUtil.addClass(n,"leaflet-disabled"),this._restyle(),e.on("rotate",this._restyle,this),this._follow=!1,this._canFollow=!1,this.options.closeOnZeroBearing&&0===e.getBearing()&&(o.style.display="none"),o},onRemove:function(t){t.off("rotate",this._restyle,this)},_handleMouseDown:function(e){t.DomEvent.stop(e),this.dragging=!0,this.dragstartX=e.pageX,this.dragstartY=e.pageY,t.DomEvent.on(document,"mousemove",this._handleMouseDrag,this).on(document,"mouseup",this._handleMouseUp,this)},_handleMouseUp:function(e){t.DomEvent.stop(e),this.dragging=!1,t.DomEvent.off(document,"mousemove",this._handleMouseDrag,this).off(document,"mouseup",this._handleMouseUp,this)},_handleMouseDrag:function(t){if(this.dragging){var e=t.clientX-this.dragstartX;this._map.setBearing(e)}},_cycleState:function(t){if(this._map){var e=this._map;e.touchRotate.enabled()||e.compassBearing.enabled()?e.compassBearing.enabled()?(e.compassBearing.disable(),e.setBearing(0),this.options.closeOnZeroBearing&&e.touchRotate.enable()):(e.touchRotate.disable(),(DeviceOrientationEvent&&DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission():Promise.resolve("granted")).then((t=>"granted"===t&&e.compassBearing.enable()))):e.touchRotate.enable(),this._restyle()}},_restyle:function(){if(this._map.options.rotate){var e=this._map,o=e.getBearing();this._arrow.style.transform="rotate("+o+"deg)",o&&this.options.closeOnZeroBearing&&(this._container.style.display="block"),e.compassBearing.enabled()?this._link.style.backgroundColor="orange":e.touchRotate.enabled()?this._link.style.backgroundColor=null:(this._link.style.backgroundColor="grey",0===o&&this.options.closeOnZeroBearing&&(this._container.style.display="none"))}else t.DomUtil.addClass(this._link,"leaflet-disabled")}}),t.control.rotate=function(e){return new t.Control.Rotate(e)},t.Map.mergeOptions({rotateControl:!0}),t.Map.addInitHook((function(){if(this.options.rotateControl){var e="object"==typeof this.options.rotateControl?this.options.rotateControl:{};this.rotateControl=t.control.rotate(e),this.addControl(this.rotateControl)}})))}(t),t}var o={install:e};t.default=o,t.install=e,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=leaflet-rotate.js.map
